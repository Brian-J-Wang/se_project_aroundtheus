!function(){"use strict";class t{constructor(t,e,s,n,o){this._data=t,this._cardTemplate=e,this._cardElement=this._cardTemplate.content.cloneNode(!0),this._cardImage=this._cardElement.querySelector(".places__image"),this._deleteButton=this._cardElement.querySelector(".places__delete"),this._heartButton=this._cardElement.querySelector(".places__heart"),this._handleImageClick=s,this._handleImageRemove=n,this._handleImageLike=o}createCard(){return this._cardImage.src=this._data.link,this._cardImage.alt=this._data.name,this._cardElement.querySelector(".places__name").textContent=this._data.name,this._data.isLiked&&this._heartButton.classList.add("places__heart_enabled"),this._setEventListeners(),this._cardElement}_setEventListeners(){this._setDeleteHandler(),this._setLikeHandler(),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._cardImage)}))}_setDeleteHandler(t){this._deleteButton.addEventListener("click",(()=>{this._handleImageRemove(this._data,this._deleteButton)}))}_setLikeHandler(t){this._heartButton.addEventListener("click",(()=>{this._handleImageLike(this._data).then((()=>{this._data.isLiked?this._heartButton.classList.add("places__heart_enabled"):this._heartButton.classList.remove("places__heart_enabled")})).catch((t=>{console.log(t)}))}))}}class e{constructor(t,e,s){this._config=e,this._formElement=t,this._formButton=document.querySelector(s),this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))})),this._toggleButtonState()}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_showInputError(t){t.classList.add(this._config.inputErrorClass);const e=this._formElement.querySelector(`.${t.id}-error`);e.textContent=t.validationMessage,e.classList.add(this._config.errorClass)}_hideInputError(t){t.classList.remove(this._config.inputErrorClass);const e=this._formElement.querySelector(`.${t.id}-error`);e.textContent="",e.classList.remove(this._config.errorClass)}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.setAttribute("disabled",""),this._buttonElement.classList.add(this._config.inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled",""),this._buttonElement.classList.remove(this._config.inactiveButtonClass))}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}resetForm(){this._toggleButtonState()}}class s{constructor(t){this._popupElement=document.querySelector(t),this._popupCloseButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=t=>{"Escape"==t.key&&this.close()};_handleOverlayClose=t=>{t.target.classList.contains("modal")&&this.close()};_handleButtonClose=()=>{this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleOverlayClose),this._popupCloseButton.addEventListener("click",this._handleButtonClose)}}class n extends s{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};super(t),this._popupForm=this._popupElement.querySelector(".modal__form"),this._popupSubmitButton=this._popupForm.querySelector(".modal__button"),this._popupSubmitText=this._popupSubmitButton.textContent,this._handleFormSubmit=e,this._onFormClose=s,this._inputs=this._popupForm.querySelectorAll("input")}_getInputValues(){const t={};return this._inputs.forEach((e=>{t[e.id]=e.value})),t}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._popupSubmitButton.textContent="Saving...",this._popupSubmitButton.setAttribute("disabled",""),this._handleFormSubmit(this._getInputValues()).then((()=>{this._popupSubmitButton.textContent=this._popupSubmitText,this._popupSubmitButton.removeAttribute("disabled",""),this.close()})).catch((t=>{console.error(t)}))})),super.setEventListeners()}close(){this._popupForm.reset(),this._onFormClose(),super.close()}}const o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=new class{constructor(t){this._url=t.baseUrl,this._headers=t.headers}getUserInformation(){return this._request(this._url.concat("/users/me"),{method:"GET",headers:this._headers})}updateUserInformation(t){let{name:e,about:s}=t;return this._request(this._url.concat("/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:s})})}updateAvatar(t){return this._request(this._url.concat("/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})})}getInitialCards(){return this._request(this._url.concat("/cards"),{method:"GET",headers:this._headers})}createCard(t){let{name:e,link:s}=t;return this._request(this._url.concat("/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:s})})}deleteCard(t){return this._request(this._url.concat(`/cards/${t}`),{method:"DELETE",headers:this._headers})}addLike(t){return this._request(this._url.concat(`/cards/${t}/likes`),{method:"PUT",headers:this._headers})}removeLike(t){return this._request(this._url.concat(`/cards/${t}/likes`),{method:"DELETE",headers:this._headers})}_request(t,e){return fetch(t,e).then(this._checkResponse)}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e8616e37-d8e6-434f-880a-27a697920338","Content-Type":"application/json"}}),i=new class extends s{constructor(t){super(t),this._popupForm=this._popupElement.querySelector(".modal__form"),this._popupSubmitButton=this._popupForm.querySelector(".modal__button"),this._popupSubmitText=this._popupSubmitButton.textContent}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._popupSubmitButton.textContent="Deleting...",this._popupSubmitButton.setAttribute("disabled",""),this.onConfirm().then((()=>{this.close()})).catch((t=>{console.error(t)})).finally((()=>{this._popupSubmitButton.textContent=this._popupSubmitText,this._popupSubmitButton.removeAttribute("disabled","")}))})),super.setEventListeners()}onPopupConfirm(t){this.onConfirm=t,this.open()}}(".modal[id=confirmModal]");i.setEventListeners();const a=document.querySelector("#card"),l=e=>new t(e,a,c,((t,e)=>{i.onPopupConfirm((()=>r.deleteCard(t._id).then((()=>{e.closest(".places__card").remove()})).catch((t=>{console.log(t)}))))}),(t=>t.isLiked?r.removeLike(t._id).then((()=>{t.isLiked=!1})):r.addLike(t._id).then((()=>{t.isLiked=!0})))).createCard(),d=new class{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}renderItems(t){t.forEach((t=>{const e=this._renderer(t);this._container.append(e)}))}}(l,".places");r.getInitialCards().then((t=>{d.renderItems(t)})).catch((t=>{console.log(t)}));const u=new class extends s{constructor(t){super(t),this._modalImage=this._popupElement.querySelector(".modal__image"),this._modalCaption=this._popupElement.querySelector(".modal__caption")}open(t){let{name:e,link:s}=t;this._modalImage.setAttribute("src",s),this._modalImage.setAttribute("alt",e),this._modalCaption.innerText=e,super.open()}}(".modal[id=imageModal]");function c(t){const e={name:t.getAttribute("alt"),link:t.getAttribute("src")};u.open(e)}u.setEventListeners();const h=new class{constructor(t){let{name:e,desc:s,avatar:n}=t;this._name=document.querySelector(e),this._desc=document.querySelector(s),this._avatar=document.querySelector(n)}getUserInfo(){return{name:this._name.textContent,desc:this._desc.textContent}}getAvatarInfo(){return this._avatar.getAttribute("src")}setUserInfo(t){let{name:e,desc:s}=t;this._name.textContent=e,this._desc.textContent=s}setAvatarLink(t){this._avatar.setAttribute("src",t)}}({name:".profile__name",desc:".profile__desc",avatar:".profile__avatar-image"});r.getUserInformation().then((t=>{h.setUserInfo({name:t.name,desc:t.about}),h.setAvatarLink(t.avatar)})).catch((t=>{console.log(t)}));const _=new n(".modal[id=editModal]",(t=>{const e={name:t["name-input"],about:t["desc-input"]};return r.updateUserInformation({name:e.name,about:e.about}).then((t=>{h.setUserInfo({name:t.name,desc:t.about})})).catch((t=>{console.log(t)}))}));_.setEventListeners();const m=".profile__edit",p=editModal.querySelector(".modal__input[name=name]"),v=editModal.querySelector(".modal__input[name=desc]");document.querySelector(m).addEventListener("click",(function(){const t=h.getUserInfo();p.value=t.name,v.value=t.desc,_.open()})),new e(document.forms.editModalForm,o,m).enableValidation();const E=".profile__avatar-container",b=(document.querySelector(".profile__avatar-image"),new n(".modal[id=editAvatarModal]",(t=>{const e=t["avatar-input"];return r.updateAvatar(e).then((t=>{h.setAvatarLink(t.avatar)})).catch((t=>{console.log(t)}))})));b.setEventListeners(),document.querySelector(E).addEventListener("click",(function(){b.open()})),new e(document.forms.editAvatarModalForm,o,E).enableValidation();const g=new n(".modal[id=addModal]",(t=>r.createCard({name:t["title-input"],link:t["link-input"]}).then((t=>{const e=l(t);d.addItem(e)})).then((()=>{L.resetForm()})).catch((t=>{console.log(t)}))),(()=>{L.resetForm()}));g.setEventListeners();const f=".profile__add";document.querySelector(f).addEventListener("click",(()=>{g.open()}));const L=new e(document.forms.addModalForm,o,f);L.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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STdKLEVBRFRPLFNBQVNnSixNQUFvQixhQUNRckosRUFBUTRKLEdBQ2xFRCxFQUFrQjlJLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9Db21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9Db21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9Db21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvQ29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvQ29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL0NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL0NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL0NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9Db21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFRlbXBsYXRlLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVJbWFnZVJlbW92ZSwgaGFuZGxlSW1hZ2VMaWtlKSB7XHJcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fY2FyZFRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2ltYWdlJyk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19fZGVsZXRlJyk7XHJcbiAgICAgICAgdGhpcy5faGVhcnRCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19oZWFydCcpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlUmVtb3ZlID0gaGFuZGxlSW1hZ2VSZW1vdmU7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VMaWtlID0gaGFuZGxlSW1hZ2VMaWtlO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2RhdGEubGluaztcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fZGF0YS5uYW1lO1xyXG5cclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19uYW1lJykudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLm5hbWU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kYXRhLmlzTGlrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZCgncGxhY2VzX19oZWFydF9lbmFibGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3NldERlbGV0ZUhhbmRsZXIoKTtcclxuICAgICAgICB0aGlzLl9zZXRMaWtlSGFuZGxlcigpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9jYXJkSW1hZ2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXREZWxldGVIYW5kbGVyKGNhcmRDb3B5KSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUltYWdlUmVtb3ZlKHRoaXMuX2RhdGEsIHRoaXMuX2RlbGV0ZUJ1dHRvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldExpa2VIYW5kbGVyKGNhcmRDb3B5KSB7XHJcbiAgICAgICAgdGhpcy5faGVhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VMaWtlKHRoaXMuX2RhdGEpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kYXRhLmlzTGlrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwbGFjZXNfX2hlYXJ0X2VuYWJsZWQnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgncGxhY2VzX19oZWFydF9lbmFibGVkJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChyZWogPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVqKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IENhcmQgfTsiLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGZvcm1FbGVtZW50LCBjb25maWcsIGZvcm1CdXR0b25TZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2Zvcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1CdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSkgXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG5cclxuICAgICAgICBjb25zdCBpbnB1dEVycm9yU3BhbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFcnJvclNwYW5FbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICAgIGlucHV0RXJyb3JTcGFuRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvcm1FcnJvclNwYW4gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZm9ybUVycm9yU3Bhbi50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgZm9ybUVycm9yU3Bhbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRGb3JtKCkge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgIT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVPdmVybGF5Q2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbCcpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUJ1dHRvbkNsb3NlID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAvL2Nsb3NlIGJ5IG92ZXJsYXlcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcclxuXHJcbiAgICAgICAgLy9jbG9zZSBieSBjbG9zZSBidXR0b25cclxuICAgICAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlQnV0dG9uQ2xvc2UpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgb25Gb3JtQ2xvc2UgPSAoKSA9PiB7fSkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwU3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRUZXh0ID0gdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fb25Gb3JtQ2xvc2UgPSBvbkZvcm1DbG9zZTtcclxuICAgICAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXRWYWx1ZXNbZWxlbWVudC5pZF0gPSBlbGVtZW50LnZhbHVlOyBcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcclxuICAgICAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3B1cFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3BvcHVwU3VibWl0VGV4dDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BvcHVwU3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChyZWplY3QgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZWplY3QpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgICAgICB0aGlzLl9vbkZvcm1DbG9zZSgpO1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IFBvcHVwV2l0aEZvcm0gfTsiLCJpbXBvcnQgQXBpIGZyb20gXCIuLi9Db21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG5cclxuY29uc3QgQVBJID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IFwiZTg2MTZlMzctZDhlNi00MzRmLTg4MGEtMjdhNjk3OTIwMzM4XCIsXHJcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZXhwb3J0IHtjb25maWcsIEFQSX0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KHRoaXMuX3VybC5jb25jYXQoXCIvdXNlcnMvbWVcIiksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVVc2VySW5mb3JtYXRpb24oe25hbWUsIGFib3V0fSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KHRoaXMuX3VybC5jb25jYXQoXCIvdXNlcnMvbWVcIiksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiBhYm91dFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUF2YXRhcihhdmF0YXJMaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QodGhpcy5fdXJsLmNvbmNhdChcIi91c2Vycy9tZS9hdmF0YXJcIiksIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhcjogYXZhdGFyTGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCh0aGlzLl91cmwuY29uY2F0KFwiL2NhcmRzXCIpLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUNhcmQoe25hbWUsIGxpbmt9KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QodGhpcy5fdXJsLmNvbmNhdChcIi9jYXJkc1wiKSwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgbGluazogbGlua1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QodGhpcy5fdXJsLmNvbmNhdChgL2NhcmRzLyR7Y2FyZElkfWApLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QodGhpcy5fdXJsLmNvbmNhdChgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2ApLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QodGhpcy5fdXJsLmNvbmNhdChgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2ApLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vQ29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vQ29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9Db21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9Db21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9Db21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0ICcuLi9zdHlsZXMvc3R5bGUuY3NzJztcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9Db21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9Db21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcclxuaW1wb3J0IHsgY29uZmlnLCBBUEkgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5jb25zdCBjb25maXJtUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybSgnLm1vZGFsW2lkPWNvbmZpcm1Nb2RhbF0nKTtcclxuY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZCcpO1xyXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgICByZXR1cm4gbmV3IENhcmQoY2FyZERhdGEsIGNhcmRUZW1wbGF0ZSwgb3BlbkltYWdlTW9kYWwsIFxyXG4gICAgKGRhdGEsIGRlbGV0ZUJ1dHRvbikgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Qb3B1cC5vblBvcHVwQ29uZmlybSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBBUEkuZGVsZXRlQ2FyZChkYXRhLl9pZClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlQnV0dG9uLmNsb3Nlc3QoJy5wbGFjZXNfX2NhcmQnKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChyZWopID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9LCBcclxuICAgIChkYXRhKSA9PiB7XHJcbiAgICAgICAgaWYgKCFkYXRhLmlzTGlrZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEFQSS5hZGRMaWtlKGRhdGEuX2lkKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkYXRhLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gQVBJLnJlbW92ZUxpa2UoZGF0YS5faWQpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGRhdGEuaXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KS5jcmVhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24ocmVuZGVyQ2FyZCwgXCIucGxhY2VzXCIpO1xyXG5BUEkuZ2V0SW5pdGlhbENhcmRzKClcclxuLnRoZW4oY2FyZHMgPT4ge1xyXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xyXG59KVxyXG4uY2F0Y2gocmVqID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHJlaik7XHJcbn0pXHJcblxyXG4vL0ltYWdlIG1vZGFsXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5tb2RhbFtpZD1pbWFnZU1vZGFsXScpO1xyXG5mdW5jdGlvbiBvcGVuSW1hZ2VNb2RhbChjYXJkSW1hZ2UpIHtcclxuICAgIGNvbnN0IGNhcmREYXRhID0ge1xyXG4gICAgICAgIG5hbWU6IGNhcmRJbWFnZS5nZXRBdHRyaWJ1dGUoJ2FsdCcpLFxyXG4gICAgICAgIGxpbms6IGNhcmRJbWFnZS5nZXRBdHRyaWJ1dGUoJ3NyYycpXHJcbiAgICB9XHJcblxyXG4gICAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1VzZXIgSW5mb3JtYXRpb25cclxuY29uc3QgbmFtZVNlbGVjdG9yID0gJy5wcm9maWxlX19uYW1lJztcclxuY29uc3QgZGVzY1NlbGVjdG9yID0gJy5wcm9maWxlX19kZXNjJztcclxuY29uc3QgYXZhdGFyU2VsZWN0b3IgPSAnLnByb2ZpbGVfX2F2YXRhci1pbWFnZSc7XHJcbmNvbnN0IHVzZXJQcm9maWxlID0gbmV3IFVzZXJJbmZvKHtuYW1lOiBuYW1lU2VsZWN0b3IsIGRlc2M6IGRlc2NTZWxlY3RvciwgYXZhdGFyOiBhdmF0YXJTZWxlY3Rvcn0pO1xyXG5BUEkuZ2V0VXNlckluZm9ybWF0aW9uKClcclxuICAgIC50aGVuKHVzZXJJbmZvID0+IHtcclxuICAgICAgICB1c2VyUHJvZmlsZS5zZXRVc2VySW5mbyh7bmFtZTogdXNlckluZm8ubmFtZSwgZGVzYzogdXNlckluZm8uYWJvdXR9KTtcclxuICAgICAgICB1c2VyUHJvZmlsZS5zZXRBdmF0YXJMaW5rKHVzZXJJbmZvLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKHJlaiA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVqKTtcclxuICAgIH0pO1xyXG5cclxuLy9FZGl0IHVzZXIgaW5mbyBtb2RhbFxyXG5jb25zdCBlZGl0SW5mb0Zvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSgnLm1vZGFsW2lkPWVkaXRNb2RhbF0nLChpbnB1dHMpID0+IHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xyXG4gICAgICAgIG5hbWU6IGlucHV0c1snbmFtZS1pbnB1dCddLFxyXG4gICAgICAgIGFib3V0OiBpbnB1dHNbJ2Rlc2MtaW5wdXQnXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBBUEkudXBkYXRlVXNlckluZm9ybWF0aW9uKHtuYW1lOiB1c2VySW5mby5uYW1lLCBhYm91dDogdXNlckluZm8uYWJvdXR9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKHtuYW1lOiByZXMubmFtZSwgZGVzYzogcmVzLmFib3V0fSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKHJlaiA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVqKTtcclxuICAgIH0pO1xyXG59KVxyXG5lZGl0SW5mb0Zvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b25TZWxlY3RvciA9ICcucHJvZmlsZV9fZWRpdCc7XHJcbmNvbnN0IGlucHV0TmFtZSA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0W25hbWU9bmFtZV0nKTtcclxuY29uc3QgaW5wdXREZXNjID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRbbmFtZT1kZXNjXScpO1xyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlZGl0QnV0dG9uU2VsZWN0b3IpO1xyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVNb2RhbCk7XHJcbmZ1bmN0aW9uIG9wZW5Qcm9maWxlTW9kYWwoKSB7XHJcbiAgICBjb25zdCB1c2VySW5mbyA9IHVzZXJQcm9maWxlLmdldFVzZXJJbmZvKCk7XHJcblxyXG4gICAgaW5wdXROYW1lLnZhbHVlID0gdXNlckluZm8ubmFtZTtcclxuICAgIGlucHV0RGVzYy52YWx1ZSA9IHVzZXJJbmZvLmRlc2M7XHJcbiAgICBlZGl0SW5mb0Zvcm0ub3BlbigpO1xyXG59XHJcblxyXG5jb25zdCBlZGl0TW9kYWxGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2VkaXRNb2RhbEZvcm0nXTtcclxuY29uc3QgZWRpdE1vZGFsVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZWRpdE1vZGFsRm9ybSwgY29uZmlnLCBlZGl0QnV0dG9uU2VsZWN0b3IpO1xyXG5lZGl0TW9kYWxWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy9FZGl0IHVzZXIgYXZhdGFyIG1vZGFsXHJcbmNvbnN0IGVkaXRBdmF0YXJTZWxlY3RvciA9ICcucHJvZmlsZV9fYXZhdGFyLWNvbnRhaW5lcic7XHJcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1pbWFnZScpO1xyXG5jb25zdCBlZGl0QXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKCcubW9kYWxbaWQ9ZWRpdEF2YXRhck1vZGFsXScsIChpbnB1dHMpID0+IHtcclxuICAgIGNvbnN0IGxpbmtJbnB1dCA9IGlucHV0c1snYXZhdGFyLWlucHV0J107XHJcblxyXG4gICAgcmV0dXJuIEFQSS51cGRhdGVBdmF0YXIobGlua0lucHV0KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICB1c2VyUHJvZmlsZS5zZXRBdmF0YXJMaW5rKHJlcy5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChyZWogPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlaik7XHJcbiAgICB9KVxyXG59KVxyXG5lZGl0QXZhdGFyRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWRpdEF2YXRhclNlbGVjdG9yKTtcclxuYXZhdGFyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5FZGl0QXZhdGFyTW9kYWwpXHJcbmZ1bmN0aW9uIG9wZW5FZGl0QXZhdGFyTW9kYWwoKSB7XHJcbiAgICBlZGl0QXZhdGFyRm9ybS5vcGVuKCk7ICAgIFxyXG59XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbEZvcm0gPSBkb2N1bWVudC5mb3Jtc1snZWRpdEF2YXRhck1vZGFsRm9ybSddXHJcbmNvbnN0IGF2YXRhck1vZGFsVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYXZhdGFyTW9kYWxGb3JtLCBjb25maWcsIGVkaXRBdmF0YXJTZWxlY3Rvcik7XHJcbmF2YXRhck1vZGFsVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vQWRkIG1vZGFsIGZ1bmN0aW9uc1xyXG5jb25zdCBhZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5tb2RhbFtpZD1hZGRNb2RhbF0nLCBcclxuKGlucHV0cykgPT4ge1xyXG4gICAgcmV0dXJuIEFQSS5jcmVhdGVDYXJkKHtuYW1lOiBpbnB1dHNbJ3RpdGxlLWlucHV0J10sIGxpbms6IGlucHV0c1snbGluay1pbnB1dCddfSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xyXG4gICAgfSlcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBhZGRNb2RhbFZhbGlkYXRvci5yZXNldEZvcm0oKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2gocmVqID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZWopO1xyXG4gICAgfSlcclxufSxcclxuKCkgPT4ge1xyXG4gICAgYWRkTW9kYWxWYWxpZGF0b3IucmVzZXRGb3JtKCk7XHJcbn0pO1xyXG5hZGRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhZGRCdXR0b25TZWxlY3RvciA9ICcucHJvZmlsZV9fYWRkJztcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhZGRCdXR0b25TZWxlY3Rvcik7XHJcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGFkZEZvcm0ub3BlbigpO1xyXG59KVxyXG5cclxuY29uc3QgYWRkTW9kYWxGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2FkZE1vZGFsRm9ybSddXHJcbmNvbnN0IGFkZE1vZGFsVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYWRkTW9kYWxGb3JtLCBjb25maWcsIGFkZEJ1dHRvblNlbGVjdG9yKTtcclxuYWRkTW9kYWxWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKTtcclxuICAgICAgICB0aGlzLl9wb3B1cFN1Ym1pdFRleHQgPSB0aGlzLl9wb3B1cFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gJ0RlbGV0aW5nLi4uJztcclxuICAgICAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMub25Db25maXJtKClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2gocmVqZWN0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVqZWN0KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcG9wdXBTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9wb3B1cFN1Ym1pdFRleHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3B1cFN1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBvcHVwQ29uZmlybShvbkNvbmZpcm0pIHtcclxuICAgICAgICB0aGlzLm9uQ29uZmlybSA9IG9uQ29uZmlybTtcclxuICAgICAgICB0aGlzLm9wZW4oKTtcclxuICAgIH0gICAgXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIC8vaXRlbXM6IGFycmF5LCByZW5kZXJlcjogZnVuY3Rpb25cclxuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH0gXHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgICAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl9tb2RhbENhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jYXB0aW9uJyk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG9wZW4oe25hbWUsIGxpbmt9KSB7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIGxpbmspO1xyXG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCBuYW1lKTtcclxuICAgICAgICB0aGlzLl9tb2RhbENhcHRpb24uaW5uZXJUZXh0ID0gbmFtZTtcclxuXHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3Ioe25hbWUsIGRlc2MsIGF2YXRhcn0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lKTtcclxuICAgICAgICB0aGlzLl9kZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgZGVzYzogdGhpcy5fZGVzYy50ZXh0Q29udGVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRBdmF0YXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hdmF0YXIuZ2V0QXR0cmlidXRlKCdzcmMnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh7bmFtZSwgZGVzY30pIHtcclxuICAgICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9kZXNjLnRleHRDb250ZW50ID0gZGVzYztcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdmF0YXJMaW5rKGxpbmspIHtcclxuICAgICAgICB0aGlzLl9hdmF0YXIuc2V0QXR0cmlidXRlKCdzcmMnLCBsaW5rKTtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUltYWdlUmVtb3ZlIiwiaGFuZGxlSW1hZ2VMaWtlIiwidGhpcyIsIl9kYXRhIiwiX2NhcmRUZW1wbGF0ZSIsIl9jYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZEltYWdlIiwicXVlcnlTZWxlY3RvciIsIl9kZWxldGVCdXR0b24iLCJfaGVhcnRCdXR0b24iLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVJbWFnZVJlbW92ZSIsIl9oYW5kbGVJbWFnZUxpa2UiLCJjcmVhdGVDYXJkIiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJ0ZXh0Q29udGVudCIsImlzTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfc2V0RGVsZXRlSGFuZGxlciIsIl9zZXRMaWtlSGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJjYXJkQ29weSIsInRoZW4iLCJyZW1vdmUiLCJjYXRjaCIsInJlaiIsImNvbnNvbGUiLCJsb2ciLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJjb25maWciLCJmb3JtQnV0dG9uU2VsZWN0b3IiLCJfY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2Zvcm1CdXR0b24iLCJkb2N1bWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9idXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yU3BhbkVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsImZvcm1FcnJvclNwYW4iLCJfaGFzSW52YWxpZElucHV0Iiwic2V0QXR0cmlidXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJyZXNldEZvcm0iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX3BvcHVwQ2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiX2hhbmRsZU92ZXJsYXlDbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX2hhbmRsZUJ1dHRvbkNsb3NlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIm9uRm9ybUNsb3NlIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX3BvcHVwU3VibWl0QnV0dG9uIiwiX3BvcHVwU3VibWl0VGV4dCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX29uRm9ybUNsb3NlIiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiZWxlbWVudCIsInZhbHVlIiwicmVqZWN0IiwiZXJyb3IiLCJyZXNldCIsImZvcm1TZWxlY3RvciIsIkFQSSIsIm9wdGlvbnMiLCJfdXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImdldFVzZXJJbmZvcm1hdGlvbiIsIl9yZXF1ZXN0IiwiY29uY2F0IiwibWV0aG9kIiwidXBkYXRlVXNlckluZm9ybWF0aW9uIiwiX3JlZiIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXJMaW5rIiwiYXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiX3JlZjIiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJ1cmwiLCJmZXRjaCIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJjb25maXJtUG9wdXAiLCJvbkNvbmZpcm0iLCJmaW5hbGx5Iiwib25Qb3B1cENvbmZpcm0iLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJvcGVuSW1hZ2VNb2RhbCIsImRlbGV0ZUJ1dHRvbiIsIl9pZCIsImNsb3Nlc3QiLCJjYXJkU2VjdGlvbiIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiY2FyZEVsZW1lbnQiLCJhcHBlbmQiLCJjYXJkcyIsImltYWdlUG9wdXAiLCJfbW9kYWxJbWFnZSIsIl9tb2RhbENhcHRpb24iLCJpbm5lclRleHQiLCJjYXJkSW1hZ2UiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VyUHJvZmlsZSIsImRlc2MiLCJfbmFtZSIsIl9kZXNjIiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwiZ2V0QXZhdGFySW5mbyIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyTGluayIsInVzZXJJbmZvIiwiZWRpdEluZm9Gb3JtIiwiaW5wdXRzIiwiZWRpdEJ1dHRvblNlbGVjdG9yIiwiaW5wdXROYW1lIiwiZWRpdE1vZGFsIiwiaW5wdXREZXNjIiwiZm9ybXMiLCJlZGl0QXZhdGFyU2VsZWN0b3IiLCJlZGl0QXZhdGFyRm9ybSIsImxpbmtJbnB1dCIsImFkZEZvcm0iLCJjYXJkIiwiYWRkTW9kYWxWYWxpZGF0b3IiLCJhZGRCdXR0b25TZWxlY3RvciJdLCJzb3VyY2VSb290IjoiIn0=